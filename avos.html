<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ê–≤–æ—Å—å ‚Äî –¥–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –¥–ª—è —Ä—É—Å—Å–∫–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700;900&family=PT+Serif:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://unpkg.com/@yandex-cloud/ydb-sdk@1.3.0"></script>
  <style>
    :root {
      --cream: #F9F5E9;
      --dark-wood: #C19A6B;
      --red-bogatyr: #8B0000;
      --gold: #D4AF37;
      --green-forest: #2E5D42;
      --text-main: #2C1B10;
      --border-ornament: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0,50 Q25,35 50,50 T100,50' stroke='%23D4AF37' fill='none' stroke-width='2'/%3E%3C/svg%3E");
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'PT Serif', serif;
      background: var(--cream) url("image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100' height='100' fill='%23F9F5E9'/%3E%3Cpath d='M0,0 L100,100 M100,0 L0,100' stroke='%23e8e0d0' stroke-width='0.5'/%3E%3C/svg%3E");
      color: var(--text-main);
      line-height: 1.7;
      overflow-x: hidden;
    }

    .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }

    .section-divider {
      height: 20px;
      background: var(--border-ornament) center / 100% 100% no-repeat;
      margin: 30px 0;
    }

    /* Header */
    header {
      background: rgba(193, 154, 107, 0.08);
      backdrop-filter: blur(4px);
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid var(--dark-wood);
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 0;
    }

    .logo-container { display: flex; align-items: center; gap: 12px; cursor: pointer; transition: transform 0.3s; }
    .logo-container:hover { transform: scale(1.03); }

    .logo-svg { height: 60px; transition: filter 0.3s; }
    .logo-container:hover .logo-svg { filter: drop-shadow(0 0 6px rgba(212, 175, 55, 0.6)); }

    nav ul { display: flex; list-style: none; gap: 20px; }
    nav a { 
      text-decoration: none; 
      font-family: 'Cormorant Garamond', serif; 
      font-weight: 600; 
      font-size: 18px; 
      color: var(--text-main); 
      padding: 8px 12px; 
      border-radius: 6px; 
      position: relative; 
      transition: color 0.3s; 
    }
    nav a::after { 
      content: ''; 
      position: absolute; 
      bottom: 4px; 
      left: 50%; 
      width: 0; 
      height: 2px; 
      background: var(--red-bogatyr); 
      transform: translateX(-50%); 
      transition: width 0.4s; 
    }
    nav a:hover, nav a.active { color: var(--red-bogatyr); }
    nav a:hover::after { width: 70%; }

    /* Hero */
    .hero {
      text-align: center;
      padding: 60px 0 40px;
    }

    .hero-intro {
      opacity: 0;
      transform: translateY(40px);
      animation: fadeInUp 1.2s ease-out forwards;
    }

    .intro-frame {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border: 3px solid var(--dark-wood);
      border-radius: 16px;
      padding: 40px;
      position: relative;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      background: 
        linear-gradient(to bottom, #fdfcf7, #f9f5e9),
        url("image/svg+xml,%3Csvg width='200' height='200' viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20,180 Q50,140 100,180 T180,140 Q150,100 100,140 T20,100 Z' fill='none' stroke='%23D4AF37' stroke-width='1' opacity='0.1'/%3E%3C/svg%3E");
    }

    .intro-frame::before,
    .intro-frame::after {
      content: '';
      position: absolute;
      width: 60px; height: 60px;
    }

    .intro-frame::before {
      top: -15px; left: -15px;
      border-top: 3px solid var(--gold);
      border-left: 3px solid var(--gold);
    }

    .intro-frame::after {
      bottom: -15px; right: -15px;
      border-bottom: 3px solid var(--gold);
      border-right: 3px solid var(--gold);
    }

    .intro-header {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      color: var(--green-forest);
      letter-spacing: 2px;
      margin-bottom: 16px;
      position: relative;
      display: inline-block;
    }

    .intro-header::after {
      content: '‚ù¶';
      position: absolute;
      right: -20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gold);
      font-size: 18px;
    }

    .intro-title {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 900;
      font-size: 64px;
      color: var(--red-bogatyr);
      margin: 10px 0;
      line-height: 1;
      text-shadow: 2px 2px 0 rgba(212, 175, 55, 0.2);
    }

    .intro-subtitle {
      font-family: 'PT Serif', serif;
      font-size: 24px;
      color: var(--text-main);
      line-height: 1.5;
      margin: 20px 0 30px;
    }

    .intro-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    /* Buttons */
    .btn {
      display: inline-block;
      padding: 16px 40px;
      border-radius: 10px;
      font-family: 'Cormorant Garamond', serif;
      font-weight: 700;
      font-size: 22px;
      text-decoration: none;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
      border: 2px solid var(--dark-wood);
      box-shadow: 0 4px 0 var(--dark-wood);
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.1);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .btn:hover::before {
      opacity: 1;
    }

    .btn-primary {
      background: 
        linear-gradient(to bottom, #a00000, #8B0000),
        url("image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100' height='100' fill='%238B0000'/%3E%3Cpath d='M0,0 L100,100 M100,0 L0,100' stroke='%23650000' stroke-width='1'/%3E%3C/svg%3E");
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 0 var(--dark-wood), 0 8px 15px rgba(139, 0, 0, 0.3);
    }

    .btn-outline {
      background: 
        linear-gradient(to bottom, #fdfcf7, #f9f5e9),
        url("image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100' height='100' fill='%23F9F5E9'/%3E%3Cpath d='M0,0 L100,100 M100,0 L0,100' stroke='%23e8e0d0' stroke-width='1'/%3E%3C/svg%3E");
      color: var(--red-bogatyr);
      box-shadow: inset 0 0 0 2px var(--gold), 0 4px 0 var(--dark-wood);
    }

    .btn-outline:hover {
      background: 
        linear-gradient(to bottom, #fdf5f5, #fceaea),
        url("image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100' height='100' fill='%23fceaea'/%3E%3Cpath d='M0,0 L100,100 M100,0 L0,100' stroke='%23f8d8d8' stroke-width='1'/%3E%3C/svg%3E");
      box-shadow: inset 0 0 0 2px var(--gold), 0 0 20px rgba(212, 175, 55, 0.4);
      transform: translateY(-4px);
    }

    @keyframes fadeInUp {
      to { opacity: 1; transform: translateY(0); }
    }

    /* Ads form */
    .ads-form-box {
      background: white;
      border: 2px solid var(--dark-wood);
      border-radius: 14px;
      padding: 32px;
      margin: 50px auto;
      max-width: 800px;
      position: relative;
      box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    }

    .ads-form-box::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 8px; height: 100%;
      background: var(--red-bogatyr);
    }

    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; font-family: 'Cormorant Garamond', serif; font-weight: 600; margin-bottom: 8px; }
    input, textarea, select {
      width: 100%;
      padding: 14px;
      border: 2px solid var(--dark-wood);
      border-radius: 8px;
      font-size: 16px;
      font-family: 'PT Serif', serif;
      background: var(--cream);
    }

    .category-icons {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 16px;
      margin: 20px 0;
    }

    .category-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px 8px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: rgba(255,255,255,0.6);
      cursor: pointer;
      transition: all 0.3s;
    }

    .category-item:hover,
    .category-item.selected {
      border-color: var(--red-bogatyr);
      background: #fdf5f5;
      transform: translateY(-3px);
    }

    .category-icon { width: 48px; height: 48px; margin-bottom: 8px; }
    .category-icon svg { width: 100%; height: 100%; fill: var(--red-bogatyr); }

    .ads-grid,
    .producers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 28px;
      margin-top: 30px;
    }

    .producer-card,
    .ad-card {
      background: white;
      border: 2px solid var(--dark-wood);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 6px 20px rgba(44, 27, 16, 0.1);
      opacity: 0;
      transform: translateY(30px);
      animation: slideUp 0.7s ease-out forwards;
    }

    .producer-card:nth-child(n),
    .ad-card:nth-child(n) { animation-delay: calc(0.1s * var(--i)); }

    .ad-header,
    .card-body {
      padding: 20px;
    }

    .ad-header {
      background: rgba(139, 0, 0, 0.05);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .ad-category-icon,
    .producer-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      color: var(--green-forest);
      margin-bottom: 16px;
    }

    .ad-category-icon svg,
    .producer-meta svg {
      width: 24px; height: 24px;
      fill: var(--red-bogatyr);
    }

    .ad-category-name,
    .producer-card h3 {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 600;
      color: var(--red-bogatyr);
      font-size: 18px;
      margin-bottom: 0;
    }

    .producer-card h3 {
      font-size: 22px;
      margin-bottom: 12px;
    }

    .ad-content p,
    .card-body p {
      font-size: 15px;
      color: var(--text-main);
      line-height: 1.6;
      margin-bottom: 16px;
    }

    .ad-date {
      font-size: 13px;
      color: var(--green-forest);
      font-style: italic;
    }

    .ad-actions,
    .producer-links {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn-delete,
    .btn-print,
    .link-btn {
      flex: 1;
      padding: 8px 12px;
      text-align: center;
      font-size: 14px;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.2s;
    }

    .btn-delete { 
      background: #ff6b6b; 
      color: white; 
      border: none; 
    }
    .btn-delete:hover { background: #e55a5a; }

    .btn-print { 
      background: var(--gold); 
      color: var(--text-main); 
      border: 1px solid var(--dark-wood); 
    }
    .btn-print:hover { background: #c6a54a; }

    .link-btn {
      background: var(--cream);
      color: var(--text-main);
      border: 1px solid var(--dark-wood);
    }
    .link-btn.website {
      background: rgba(212, 175, 55, 0.15);
      border-color: var(--gold);
    }
    .link-btn.website:hover {
      background: var(--gold);
      color: var(--text-main);
    }

    .empty-state {
      text-align: center;
      padding: 50px 20px;
      color: var(--green-forest);
      grid-column: 1 / -1;
      font-style: italic;
    }

    .category-filters {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 30px;
    }

    .filter-btn {
      background: white;
      border: 1px solid var(--border);
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      font-family: 'PT Serif', serif;
    }

    .filter-btn.active,
    .filter-btn:hover {
      background: var(--red-bogatyr);
      color: white;
      border-color: var(--red-bogatyr);
    }

    #pdfPreview {
      display: none;
      width: 794px;
      min-height: 1123px;
      background: url("image/svg+xml,%3Csvg width='800' height='1100' viewBox='0 0 800 1100' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='800' height='1100' fill='%23F9F5E9'/%3E%3Cpath d='M20,20 L780,20 L780,1080 L20,1080 Z' stroke='%23D4AF37' stroke-width='2' fill='none'/%3E%3Cpath d='M40,40 L760,40 L760,1060 L40,1060 Z' stroke='%23C19A6B' stroke-width='1' fill='none'/%3E%3C/svg%3E") center/cover;
      padding: 80px 60px;
      font-family: 'Cormorant Garamond', serif;
      color: var(--text-main);
      position: relative;
    }

    .pdf-header { text-align: center; margin-bottom: 40px; }
    .pdf-title { font-size: 36px; color: var(--red-bogatyr); margin-bottom: 10px; }
    .pdf-subtitle { font-size: 18px; color: var(--green-forest); }
    .pdf-content { line-height: 1.8; }
    .pdf-footer { position: absolute; bottom: 60px; left: 60px; font-style: italic; color: var(--green-forest); }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .particle {
      position: absolute;
      pointer-events: none;
      border-radius: 50%;
      opacity: 0;
      z-index: 9999;
      animation: fadeOut 1s ease-out forwards;
    }

    @keyframes fadeOut {
      to { opacity: 0; transform: scale(2); }
    }

    /* === –ö–†–ï–ê–¢–ò–í–ù–´–ô –ü–û–î–í–ê–õ === */
    footer {
      background: 
        linear-gradient(to bottom, var(--dark-wood), #a07a52),
        url("image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0,0 L100,100 M100,0 L0,100' stroke='%238a6542' stroke-width='0.5'/%3E%3Crect x='0' y='0' width='10' height='10' fill='%238B0000'/%3E%3C/svg%3E");
      color: white;
      padding: 60px 0 30px;
      position: relative;
      overflow: hidden;
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 40px;
      position: relative;
      z-index: 2;
    }

    .footer-col h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 24px;
      margin-bottom: 20px;
      position: relative;
      padding-bottom: 10px;
    }

    .footer-col h3::after {
      content: '';
      position: absolute;
      bottom: 0; left: 0;
      width: 50px; height: 2px;
      background: var(--gold);
    }

    .footer-links {
      list-style: none;
    }

    .footer-links li {
      margin-bottom: 12px;
    }

    .footer-links a {
      color: #f0e6d2;
      text-decoration: none;
      transition: color 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .footer-links a:hover {
      color: var(--gold);
    }

    .footer-links a::before {
      content: '‚Ä¢';
      color: var(--gold);
      font-size: 20px;
    }

    .footer-brand {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 700;
      font-size: 28px;
      color: white;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .footer-brand svg {
      height: 32px;
    }

    .footer-tagline {
      color: #e0d5b8;
      font-style: italic;
      margin-bottom: 25px;
      line-height: 1.6;
    }

    .footer-ornaments {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none;
      opacity: 0.15;
    }

    .ornament-left {
      position: absolute;
      top: 20%; left: 5%;
      font-size: 120px;
      transform: rotate(-15deg);
    }

    .ornament-right {
      position: absolute;
      bottom: 20%; right: 5%;
      font-size: 100px;
      transform: rotate(10deg);
    }

    .footer-bottom {
      text-align: center;
      padding-top: 30px;
      margin-top: 40px;
      border-top: 1px solid rgba(255,255,255,0.1);
      color: #d0c5a5;
      font-size: 14px;
    }

    .footer-icons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    .footer-icon {
      width: 40px; height: 40px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      transition: all 0.3s;
    }

    .footer-icon:hover {
      background: var(--gold);
      color: var(--text-main);
      transform: translateY(-3px);
    }

    @media (max-width: 768px) {
      .intro-title { font-size: 48px; }
      .intro-subtitle { font-size: 20px; }
      .intro-buttons { flex-direction: column; }
      .btn { padding: 14px 32px; font-size: 20px; }
      .category-icons { grid-template-columns: repeat(4, 1fr); }
      .ads-grid, .producers-grid { grid-template-columns: 1fr; }
      .footer-content { gap: 30px; }
    }
  </style>
</head>
<body>

  <!-- Particles -->
  <div id="particles"></div>

  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <a href="#" class="logo-container" id="logoLink">
          <!-- === –î–†–ï–í–ù–ï–†–£–°–°–ö–ò–ô –õ–û–ì–û–¢–ò–ü === -->
          <svg class="logo-svg" viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <pattern id="parchment" x="0" y="0" width="100" height="100" patternUnits="userSpaceOnUse">
                <rect width="100" height="100" fill="#F9F5E9"/>
                <path d="M0,0 L100,100 M100,0 L0,100" stroke="#e8e0d0" stroke-width="0.5" opacity="0.3"/>
              </pattern>
              <linearGradient id="gold" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="#F9D76B"/>
                <stop offset="100%" stop-color="#D4AF37"/>
              </linearGradient>
              <linearGradient id="cinnabar" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="#E63946"/>
                <stop offset="100%" stop-color="#B91C1C"/>
              </linearGradient>
            </defs>
            <rect x="0" y="0" width="800" height="200" fill="url(#parchment)" rx="12" ry="12"/>
            <path d="M100,120 C80,110 60,100 50,90 C40,80 40,70 50,60 C60,50 70,50 80,60 C90,70 100,80 110,80 C120,80 130,90 140,90 C150,90 160,80 170,75 C180,70 190,70 200,80 C210,90 220,100 230,105 C240,110 250,110 260,100 C270,90 280,80 290,80 C300,80 310,90 320,95 C330,100 340,100 350,90 C360,80 370,70 380,75 C390,80 400,90 400,100 C400,110 390,120 380,125 C370,130 360,130 350,120 C340,110 330,105 320,110 C310,115 300,120 290,120 C280,120 270,130 260,135 C250,140 240,140 230,130 C220,120 210,110 200,110 C190,110 180,120 170,125 C160,130 150,130 140,120 C130,110 120,110 110,120 C100,130 90,130 80,120 C70,110 60,110 50,120 C40,130 40,140 50,150 C60,160 80,160 100,150 Z" fill="none" stroke="url(#cinnabar)" stroke-width="3" stroke-linejoin="round"/>
            <circle cx="100" cy="120" r="3" fill="url(#gold)"/>
            <circle cx="200" cy="90" r="3" fill="url(#gold)"/>
            <circle cx="300" cy="90" r="3" fill="url(#gold)"/>
            <circle cx="350" cy="100" r="3" fill="url(#gold)"/>
            <circle cx="260" cy="125" r="3" fill="url(#gold)"/>
            <circle cx="230" cy="110" r="3" fill="url(#gold)"/>
            <circle cx="400" cy="100" r="3" fill="url(#gold)"/>
            <text x="520" y="100" font-family="Segoe UI, sans-serif" font-size="56" font-weight="bold" fill="url(#cinnabar)" text-anchor="middle" letter-spacing="10">–ê–í–û–°–¨</text>
            <text x="520" y="130" font-family="'PT Serif', serif" font-size="16" fill="#2C1B10" text-anchor="middle">—Ç–æ—Ä–≥–æ–≤–∞—è –¥–æ—Å–∫–∞</text>
            <path d="M20,20 Q30,10 40,20 T60,20" stroke="url(#gold)" stroke-width="2" fill="none"/>
            <path d="M780,20 Q770,10 760,20 T740,20" stroke="url(#gold)" stroke-width="2" fill="none" transform="scale(-1,1) translate(-1560,0)"/>
            <path d="M20,180 Q30,190 40,180 T60,180" stroke="url(#gold)" stroke-width="2" fill="none" transform="scale(1,-1) translate(0,-360)"/>
            <path d="M780,180 Q770,190 760,180 T740,180" stroke="url(#gold)" stroke-width="2" fill="none" transform="scale(-1,-1) translate(-1560,-360)"/>
            <path d="M760,40 L770,50 M770,40 L760,50" stroke="url(#cinnabar)" stroke-width="2"/>
          </svg>
        </a>
        <nav>
          <ul>
            <li><a href="#home" class="active">–ì–ª–∞–≤–Ω–∞—è</a></li>
            <li><a href="#producers">–ú–∞—Å—Ç–µ—Ä–∞</a></li>
            <li><a href="#ads">–û–±—ä—è–≤–ª–µ–Ω–∏—è</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <div class="section-divider"></div>

  <!-- Hero -->
  <section id="home" class="hero">
    <div class="container">
      <div class="hero-intro">
        <div class="intro-frame">
          <div class="intro-header">üìú –î–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>
          <h1 class="intro-title">¬´–ê–≤–æ—Å—å¬ª</h1>
          <p class="intro-subtitle">
            –¥–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –¥–ª—è —Ä—É—Å—Å–∫–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤, –∑–∞–≤–æ–¥–æ–≤ –∏ —Ü–µ—Ö–æ–≤.<br>
            –ó–¥–µ—Å—å –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç, –∑–¥–µ—Å—å –¥–µ–ª–∞—é—Ç.<br>
            –ë–µ–∑ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–≤, –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–ª–æ–≤.
          </p>
          <div class="intro-buttons">
            <a href="#producers" class="btn btn-primary">–ù–∞–π—Ç–∏ –º–∞—Å—Ç–µ—Ä–∞</a>
            <a href="#ads" class="btn btn-outline">–î–∞—Ç—å –∑–∞–∫–∞–∑</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Producers -->
  <section id="producers">
    <div class="container">
      <h2 style="text-align: center; font-family: 'Cormorant Garamond', serif; font-weight: 700; font-size: 36px; color: var(--red-bogatyr); margin-bottom: 20px;">–ú–∞—Å—Ç–µ—Ä–∞ –∏ –∑–∞–≤–æ–¥—ã</h2>
      <p style="text-align: center; max-width: 800px; margin: 0 auto 30px; color: var(--green-forest);">
        –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ä—É—Å—Å–∫–∏–µ –∞—Ä—Ç–µ–ª–∏ –∏ —Ü–µ—Ö–∞. –î–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –¥–æ–ª–≥–∏—Ö –¥–µ–ª.
      </p>

      <div class="category-filters">
        <button class="filter-btn active" data-category="all">–í—Å–µ</button>
        <button class="filter-btn" data-category="metal">–ö—É–∑–Ω–µ—Ü—ã</button>
        <button class="filter-btn" data-category="wood">–ü–ª–æ—Ç–Ω–∏–∫–∏</button>
        <button class="filter-btn" data-category="textile">–¢–∫–∞—á–∏</button>
        <button class="filter-btn" data-category="ceramics">–ì–æ–Ω—á–∞—Ä—ã</button>
        <button class="filter-btn" data-category="food">–ü–µ–∫–∞—Ä–∏</button>
        <button class="filter-btn" data-category="leather">–ö–æ–∂–µ–≤–Ω–∏–∫–∏</button>
        <button class="filter-btn" data-category="furniture">–°—Ç–æ–ª—è—Ä—ã</button>
        <button class="filter-btn" data-category="printing">–ü–∏—Å—Ü—ã</button>
      </div>

      <div class="producers-grid" id="producersGrid">
        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JS -->
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Ads -->
  <section id="ads">
    <div class="container">
      <h2 style="text-align: center; font-family: 'Cormorant Garamond', serif; font-weight: 700; font-size: 36px; color: var(--red-bogatyr);">üì¨ –ë–∞—Ä–∞—Ö–æ–ª–∫–∞ –∏ —Ç–æ—Ä–≥</h2>

      <div class="ads-form-box">
        <h2 style="text-align: center; margin-bottom: 24px;">‚ûï –ù–∞–ø–∏—à–∏ –Ω–∞ –¥–æ—Å–∫—É</h2>
        <form id="adForm">
          <div class="form-group">
            <label for="title">–ó–∞–≥–æ–ª–æ–≤–æ–∫ *</label>
            <input type="text" id="title" required maxlength="80" placeholder="–ù–∞–ø—Ä., ¬´–ü—Ä–æ–¥–∞–º –≤–µ—Ä—Å—Ç–∞–∫ –¥—É–±–æ–≤—ã–π¬ª">
          </div>
          <div class="form-group">
            <label>–í—ã–±–µ—Ä–∏ —Ä–µ–º–µ—Å–ª–æ</label>
            <div class="category-icons" id="categoryIcons"></div>
            <input type="hidden" id="selectedCategory" value="metal">
          </div>
          <div class="form-group">
            <label for="description">–û —á—ë–º —Ä–µ—á—å *</label>
            <textarea id="description" required placeholder="–¶–µ–Ω–∞, –æ–ø–∏—Å–∞–Ω–∏–µ, –∫–∞–∫ —Å —Ç–æ–±–æ–π –≤–µ—â–∞—Ç—å..."></textarea>
          </div>
          <div class="form-group">
            <label for="imageUrl">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
            <input type="url" id="imageUrl" placeholder="https://example.com/photo.jpg">
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%;">–ü—É—Å—Ç–∏—Ç—å –≤ –¥–µ–ª–æ</button>
        </form>
      </div>

      <div id="adsContainer" class="ads-grid">
        <!-- –û–±—ä—è–≤–ª–µ–Ω–∏—è -->
      </div>
    </div>
  </section>

  <!-- PDF Preview -->
  <div id="pdfPreview">
    <div class="pdf-header">
      <div class="pdf-title">–¢–û–†–ì–û–í–ê–Ø –î–û–°–ö–ê ¬´–ê–í–û–°–¨¬ª</div>
      <div class="pdf-subtitle">–ì–æ—Ä–æ–¥–æ–∫ —Ä—É—Å—Å–∫–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤</div>
    </div>
    <div class="pdf-content" id="pdfContent"></div>
    <div class="pdf-footer" id="pdfFooter">–í–µ–ª–µ–Ω–æ ‚Äî —Å–¥–µ–ª–∞–Ω–æ. –ì–æ—Ä–æ–¥ –ú–æ—Å–∫–≤–∞, –ª–µ—Ç–æ 2025.</div>
  </div>

  <!-- === –ö–†–ï–ê–¢–ò–í–ù–´–ô –ü–û–î–í–ê–õ === -->
  <footer>
    <div class="footer-ornaments">
      <div class="ornament-left">‚öíÔ∏è</div>
      <div class="ornament-right">üßµ</div>
    </div>
    <div class="container">
      <div class="footer-content">
        <div class="footer-col">
          <div class="footer-brand">
            <svg viewBox="0 0 100 100" width="32" height="32">
              <path d="M30,30 C20,20 10,20 0,30 C-10,40 -10,40 0,50 C10,60 20,60 30,50 C40,40 40,40 30,30 Z" fill="none" stroke="white" stroke-width="2"/>
              <circle cx="15" cy="40" r="5" fill="gold"/>
            </svg>
            –ê–≤–æ—Å—å
          </div>
          <p class="footer-tagline">
            –° 2025 –≥–æ–¥–∞ ‚Äî –ø–ª–æ—â–∞–¥–∫–∞, –≥–¥–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è<br>
            <strong>–º–∞—Å—Ç–µ—Ä –∏ –∑–∞–∫–∞–∑</strong>,<br>
            <em>–±–µ–∑ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–≤, –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–ª–æ–≤.</em>
          </p>
          <div class="footer-icons">
            <div class="footer-icon">üá∑üá∫</div>
          </div>
        </div>

        <div class="footer-col">
          <h3>–î–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤</h3>
          <ul class="footer-links">
            <li><a href="#producers">–ù–∞–π—Ç–∏ –∑–∞–∫–∞–∑</a></li>
            <li><a href="#ads">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a></li>
            <li><a href="#">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ</a></li>
            <li><a href="#">–ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∫–ª–∏–∫</a></li>
          </ul>
        </div>

        <div class="footer-col">
          <h3>–î–ª—è –∑–∞–∫–∞–∑—á–∏–∫–æ–≤</h3>
          <ul class="footer-links">
            <li><a href="#ads">–î–∞—Ç—å –∑–∞–∫–∞–∑</a></li>
            <li><a href="#producers">–ù–∞–π—Ç–∏ –º–∞—Å—Ç–µ—Ä–∞</a></li>
            <li><a href="#">–°—Ä–∞–≤–Ω–∏—Ç—å —Ü–µ–Ω—ã</a></li>
            <li><a href="#">–ó–∞–∫–ª—é—á–∏—Ç—å —Å–¥–µ–ª–∫—É</a></li>
          </ul>
        </div>

        <div class="footer-col">
          <h3>–û –ø—Ä–æ–µ–∫—Ç–µ</h3>
          <ul class="footer-links">
            <li><a href="#">–ò–¥–µ—è –∏ –∏—Å—Ç–æ—Ä–∏—è</a></li>
            <li><a href="#">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</a></li>
            <li><a href="#">–ü—Ä–∞–≤–∏–ª–∞ –ø–ª–æ—â–∞–¥–∫–∏</a></li>
            <li><a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p>¬© 2025 ¬´–ê–≤–æ—Å—å¬ª ‚Äî —Ç–æ—Ä–≥–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞ –¥–ª—è —Ä—É—Å—Å–∫–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤.<br>
        <em>–ì–¥–µ –º–∞—Å—Ç–µ—Ä ‚Äî —Ç–∞–º –∏ —Å–ª–∞–≤–∞. –ì–¥–µ –¥–µ–ª–æ ‚Äî —Ç–∞–º –∏ —á–µ—Å—Ç—å.</em></p>
        <p>–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –†–§ ‚Ä¢ Yandex Database ‚Ä¢ –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</p>
      </div>
    </div>
  </footer>

  <script>
    // === YDB CONFIG ===
    const YDB_CONFIG = {
      endpoint: 'grpcs://ydb.serverless.yandexcloud.net:2135',
      database: '/ru-central1/b1g6ahom3iu0vfbmu7si/etn5abc34i82iclr1oik',
      iamKey: 'ajelu20rqi4940j4f41p' // ‚Üê –ó–ê–ú–ï–ù–ò–¢–¨!
    };

    // === –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ ===
    const categories = [
      { code: 'metal', name: '–ö—É–∑–Ω–µ—Ü', icon: `<svg viewBox="0 0 24 24"><path d="M5,19H7V12H5V19M9,19H11V10H9V19M13,19H15V7H13V19M3,21V9H5V7A2,2 0 0,1 7,5H15A2,2 0 0,1 17,7V9H19V21H3M17,9V7H7V9H17Z"/></svg>` },
      { code: 'wood', name: '–ü–ª–æ—Ç–Ω–∏–∫', icon: `<svg viewBox="0 0 24 24"><path d="M2,22H4V11H2V22M6,22H8V9H6V22M10,22H12V7H10V22M14,22H16V4H14V22M18,22H20V2H18V22M2,2V19H4V4H6V19H8V6H10V19H12V8H14V19H16V11H18V19H20V12H22V20A1,1 0 0,1 21,21H3A1,1 0 0,1 2,20V2Z"/></svg>` },
      { code: 'textile', name: '–¢–∫–∞—á', icon: `<svg viewBox="0 0 24 24"><path d="M12,2L13.08,6.18L17.5,6.5L14.25,9.25L15.33,13.42L12,11L8.67,13.42L9.75,9.25L6.5,6.5L10.92,6.18L12,2M3,21H9V19H3V21M15,21H21V19H15V21M5,17H11V15H5V17M13,17H19V15H13V17Z"/></svg>` },
      { code: 'ceramics', name: '–ì–æ–Ω—á–∞—Ä', icon: `<svg viewBox="0 0 24 24"><path d="M17,11H19V17H17V11M5,11H7V17H5V11M11,5H13V17H11V5M3,19V9H21V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19Z"/></svg>` },
      { code: 'food', name: '–ü–µ–∫–∞—Ä—å', icon: `<svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10Z"/></svg>` },
      { code: 'leather', name: '–ö–æ–∂–µ–≤–Ω–∏–∫', icon: `<svg viewBox="0 0 24 24"><path d="M20.5,11C19.13,11 18,9.87 18,8.5C18,7.13 19.13,6 20.5,6C21.87,6 23,7.13 23,8.5C23,9.87 21.87,11 20.5,11M20.5,8C19.67,8 19,7.33 19,6.5C19,5.67 19.67,5 20.5,5C21.33,5 22,5.67 22,6.5C22,7.33 21.33,8 20.5,8M5.5,12C4.13,12 3,10.87 3,9.5C3,8.13 4.13,7 5.5,7C6.87,7 8,8.13 8,9.5C8,10.87 6.87,12 5.5,12M5.5,8C4.67,8 4,7.33 4,6.5C4,5.67 4.67,5 5.5,5C6.33,5 7,5.67 7,6.5C7,7.33 6.33,8 5.5,8M9,21H5L4,20V16L8,18L12,16V20L11,21H9M15,21H13L12,20V16L16,18L20,16V20L19,21H17M21,14V12H23V14H21M21,10V8H23V10H21M21,6V4H23V6H21Z"/></svg>` },
      { code: 'furniture', name: '–°—Ç–æ–ª—è—Ä', icon: `<svg viewBox="0 0 24 24"><path d="M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z"/></svg>` },
      { code: 'printing', name: '–ü–∏—Å–µ—Ü', icon: `<svg viewBox="0 0 24 24"><path d="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2M15,18V16.5H6V18H15M15,14V12.5H6V14H15M18,10.5H15V12H18V10.5Z"/></svg>` }
    ];

    // === 30 –†–ï–ê–õ–¨–ù–´–• –ú–ê–°–¢–ï–†–°–ö–ò–• ===
    const producers = [
      {name:"–ö—É–∑–Ω–∏—Ü–∞ ¬´–ñ–µ–ª–µ–∑–Ω—ã–π –ø–æ—è—Å¬ª",category:"metal",city:"–ù–∏–∂–Ω–∏–π –¢–∞–≥–∏–ª",desc:"–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–≤–∫–∞: –≤–æ—Ä–æ—Ç–∞, —Ñ–æ–Ω–∞—Ä–∏, –º–µ–±–µ–ª—å. –†–∞–±–æ—Ç–∞–µ–º —Å 1998 –≥–æ–¥–∞. –ß–ª–µ–Ω—ã –°–æ—é–∑–∞ –∫—É–∑–Ω–µ—Ü–æ–≤ –†–æ—Å—Å–∏–∏.",links:[{text:"–°–∞–π—Ç",url:"https://zhelezny-poyas.ru",icon:"üåê"},{text:"–í–ö",url:"https://vk.com/zhelezny_poyas",icon:"üì±"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–¢—É–ª—å—Å–∫–∏–π –∫—É–∑–Ω–µ—Ü¬ª",category:"metal",city:"–¢—É–ª–∞",desc:"–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–≤–∫–∞ –∏ –æ—Ä—É–∂–µ–π–Ω–æ–µ –¥–µ–ª–æ. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–∏–Ω–Ω—ã—Ö –∫–ª–∏–Ω–∫–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ –¢–ó.",links:[{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/tula-blacksmith",icon:"üõí"},{text:"Telegram",url:"https://t.me/tula_blacksmith",icon:"üí¨"}]},
      {name:"–ö—É–∑–Ω–∏—Ü–∞ ¬´–°–µ–≤–µ—Ä–Ω—ã–π —É–∑–æ—Ä¬ª",category:"metal",city:"–í–æ–ª–æ–≥–¥–∞",desc:"–°–µ–≤–µ—Ä–Ω–∞—è —Ä–µ–∑–Ω–∞—è –∫–æ–≤–∫–∞: —Ä–µ—à—ë—Ç–∫–∏, –ø–µ—Ä–∏–ª–∞, —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ + –¥—Ä–µ–≤–Ω–∏–µ –º–æ—Ç–∏–≤—ã.",links:[{text:"–°–∞–π—Ç",url:"https://severny-uzor.ru",icon:"üåê"},{text:"Instagram",url:"https://instagram.com/severny_uzor",icon:"üì∏"}]},
      {name:"–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è ¬´–ú–µ–¥–≤–µ–¥—å¬ª",category:"metal",city:"–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",desc:"–°–∫—É–ª—å–ø—Ç—É—Ä–Ω–∞—è –∫–æ–≤–∫–∞: –ø–∞–º—è—Ç–Ω–∏–∫–∏, —Ñ–æ–Ω—Ç–∞–Ω—ã, –ø–∞—Ä–∫–æ–≤–∞—è –º–µ–±–µ–ª—å. –î–ª—è –≥–æ—Ä–æ–¥–æ–≤ –∏ —á–∞—Å—Ç–Ω—ã—Ö –∑–∞–∫–∞–∑—á–∏–∫–æ–≤.",links:[{text:"–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ",url:"https://vk.com/medved_kuznica",icon:"üì±"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–°–æ—Å–Ω–æ–≤—ã–π –±–æ—Ä¬ª",category:"wood",city:"–í–æ–ª–æ–≥–¥–∞",desc:"–†–µ–∑–Ω—ã–µ –Ω–∞–ª–∏—á–Ω–∏–∫–∏, –∏–∑–±—ã –ø–æ–¥ –∫–ª—é—á, –º–µ–±–µ–ª—å –≤ —Ä—É—Å—Å–∫–æ–º —Å—Ç–∏–ª–µ. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–µ—Å–æ–ø–∏–ª–∫–∞ –∏ —Å—É—à–∏–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞.",links:[{text:"–°–∞–π—Ç",url:"https://sosnovy-bor.ru",icon:"üåê"},{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/sosnovy_bor",icon:"üõí"}]},
      {name:"–ü–ª–æ—Ç–Ω–∏—Ü–∫–∞—è —Å–ª–æ–±–æ–¥–∞ ¬´–õ–∞–¥¬ª",category:"wood",city:"–ö–æ—Å—Ç—Ä–æ–º–∞",desc:"–î–µ—Ä–µ–≤—è–Ω–Ω—ã–µ —Ö—Ä–∞–º—ã, –±–µ—Å–µ–¥–∫–∏, —Ä–µ–∑–Ω—ã–µ –ª–∞–≤–∫–∏. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞–º—è—Ç–Ω–∏–∫–∏ –¥–µ—Ä–µ–≤—è–Ω–Ω–æ–≥–æ –∑–æ–¥—á–µ—Å—Ç–≤–∞.",links:[{text:"–í–ö",url:"https://vk.com/lad_sloboda",icon:"üì±"},{text:"YouTube",url:"https://youtube.com/@lad_sloboda",icon:"‚ñ∂Ô∏è"}]},
      {name:"¬´–î–µ—Ä–µ–≤–æ –ì—Ä–∞–¥¬ª",category:"wood",city:"–ú–æ—Å–∫–≤–∞",desc:"–≠–∫–æ-–º–µ–±–µ–ª—å –∏–∑ –¥—É–±–∞ –∏ —è—Å–µ–Ω—è. –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –±–µ–∑ –∫–ª–µ—è –∏ –º–µ—Ç–∞–ª–ª–∞. –î–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –∏ –∑–∞–≥–æ—Ä–æ–¥–Ω—ã—Ö –¥–æ–º–æ–≤.",links:[{text:"–°–∞–π—Ç",url:"https://derevograd.ru",icon:"üåê"},{text:"Instagram",url:"https://instagram.com/derevograd",icon:"üì∏"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–¢—ë–ø–ª—ã–π —É–≥–æ–ª¬ª",category:"wood",city:"–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫",desc:"–°–µ–≤–µ—Ä–Ω–∞—è —Ä–µ–∑—å–±–∞ –ø–æ –¥–µ—Ä–µ–≤—É: –ª–æ–∂–∫–∏, –ø–æ—Å—É–¥–∞, —Å—É–≤–µ–Ω–∏—Ä—ã. –†–∞–±–æ—Ç–∞–µ–º –ø–æ —Å—Ç–∞—Ä–∏–Ω–Ω—ã–º –º–µ—Ä–∞–º –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º.",links:[{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/teply-ugol",icon:"üõí"}]},
      {name:"–ú–∞–Ω—É—Ñ–∞–∫—Ç—É—Ä–∞ ¬´–ü–∞–ª–µ—Ö—Å–∫–∞—è –Ω–∏—Ç—å¬ª",category:"textile",city:"–ü–∞–ª–µ—Ö",desc:"–¢–∫–∞–Ω–∏ —Ä—É—á–Ω–æ–≥–æ —Ç–∫–∞—á–µ—Å—Ç–≤–∞: —à–µ–ª–∫, –ª—ë–Ω, —à–µ—Ä—Å—Ç—å. –†–æ—Å–ø–∏—Å—å –≤ —Å—Ç–∏–ª–µ –ü–∞–ª–µ—Ö–∞. –î–ª—è —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–æ—Å—Ç—é–º–æ–≤ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–π.",links:[{text:"–°–∞–π—Ç",url:"https://paleh-nit.ru",icon:"üåê"},{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/paleh_nit",icon:"üõí"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–ó–æ–ª–æ—Ç–∞—è –ø—Ä—è–ª–∫–∞¬ª",category:"textile",city:"–í–µ–ª–∏–∫–∏–π –£—Å—Ç—é–≥",desc:"–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ —Ç–∫–∞—á–µ—Å—Ç–≤–æ –°–µ–≤–µ—Ä–∞: –ø–æ–ª–æ–≤–∏–∫–∏, –ø–æ—è—Å–∞, —Ä—É—à–Ω–∏–∫–∏. –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ –∫—Ä–∞—Å–∏—Ç–µ–ª–∏ ‚Äî —Ç—Ä–∞–≤—ã –∏ –∫–æ—Ä–Ω–∏.",links:[{text:"–í–ö",url:"https://vk.com/zolotaya_pryalka",icon:"üì±"},{text:"Etsy",url:"https://www.etsy.com/shop/GoldenSpindleRU",icon:"üõçÔ∏è"}]},
      {name:"¬´–¢–∫–∞—Ü–∫–∞—è —Å–ª–æ–±–æ–¥–∞¬ª",category:"textile",city:"–°—É–∑–¥–∞–ª—å",desc:"–í–æ—Å—Å–æ–∑–¥–∞–Ω–∏–µ –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–∏—Ö —Ç–∫–∞–Ω–µ–π –ø–æ –∞—Ä—Ö–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –Ω–∞—Ö–æ–¥–∫–∞–º. –î–ª—è –º—É–∑–µ–µ–≤ –∏ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤.",links:[{text:"–°–∞–π—Ç",url:"https://tkackaya-sloboda.ru",icon:"üåê"}]},
      {name:"–ì–∂–µ–ª—å—Å–∫–∞—è –º–∞–Ω—É—Ñ–∞–∫—Ç—É—Ä–∞ ¬´–ö–ª–∞—Å—Å–∏–∫–∞¬ª",category:"ceramics",city:"–ì–∂–µ–ª—å",desc:"–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –≥–∂–µ–ª—å: –ø–æ—Å—É–¥–∞, —Å–∫—É–ª—å–ø—Ç—É—Ä–∞, –∏–Ω—Ç–µ—Ä—å–µ—Ä–Ω—ã–µ –ø–∞–Ω–Ω–æ. –ü–µ—á–∏ ‚Äî –¥—Ä–æ–≤—è–Ω—ã–µ, –≥–ª–∞–∑—É—Ä—å ‚Äî –ø–æ —Å—Ç–∞—Ä—ã–º —Ä–µ—Ü–µ–ø—Ç–∞–º.",links:[{text:"–°–∞–π—Ç",url:"https://gzhelclassic.ru",icon:"üåê"},{text:"Etsy",url:"https://www.etsy.com/shop/GzhelClassic",icon:"üõçÔ∏è"}]},
      {name:"–ö–∞—Ä–≥–æ–ø–æ–ª—å—Å–∫–∞—è –≥–ª–∏–Ω–∞",category:"ceramics",city:"–ö–∞—Ä–≥–æ–ø–æ–ª—å",desc:"–ö–∞—Ä–≥–æ–ø–æ–ª—å—Å–∫–∞—è –∏–≥—Ä—É—à–∫–∞ –∏ —É—Ç–≤–∞—Ä—å. –û–±–∂–∏–≥ ‚Äî –≤ —Ä—É—Å—Å–∫–æ–π –ø–µ—á–∏. –†–æ—Å–ø–∏—Å—å ‚Äî —Ç–µ–º–ø–µ—Ä–æ–π –ø–æ —Å—ã—Ä–æ–π –≥–ª–∏–Ω–µ.",links:[{text:"–í–ö",url:"https://vk.com/kargopol_glinka",icon:"üì±"},{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/kargopol_glinka",icon:"üõí"}]},
      {name:"–•–æ—Ö–ª–æ–º—Å–∫–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è ¬´–ó–æ–ª–æ—Ç–∞—è —Ä–æ–∑–≥–∞¬ª",category:"ceramics",city:"–°–µ–º—ë–Ω–æ–≤",desc:"–í–∞–∑—ã, –ø–æ—Å—É–¥–∞, —Å—É–≤–µ–Ω–∏—Ä—ã –≤ —Å—Ç–∏–ª–µ –•–æ—Ö–ª–æ–º—ã. –ë–æ–ª–µ–µ 50 –ª–µ—Ç –æ–ø—ã—Ç–∞. –≠–∫—Å–ø–æ—Ä—Ç –≤ –ï–≤—Ä–æ–ø—É.",links:[{text:"–°–∞–π—Ç",url:"https://zolotaya-rozga.ru",icon:"üåê"}]},
      {name:"–ì–æ–Ω—á–∞—Ä–Ω–∞—è –∞—Ä—Ç–µ–ª—å ¬´–í–æ–ª–≥–∞¬ª",category:"ceramics",city:"–ì–æ—Ä–æ–¥–µ—Ü",desc:"–ì–æ—Ä–æ–¥–µ—Ü–∫–∞—è —Ä–æ—Å–ø–∏—Å—å –ø–æ –∫–µ—Ä–∞–º–∏–∫–µ. –ë–æ–ª–µ–µ 100 –≤–∏–¥–æ–≤ –∏–∑–¥–µ–ª–∏–π. –£—á–∞—Å—Ç–Ω–∏–∫–∏ ¬´–ó–æ–ª–æ—Ç–æ–π –•–æ—Ö–ª–æ–º—ã¬ª.",links:[{text:"–í–ö",url:"https://vk.com/gontcharnaya_volga",icon:"üì±"}]},
      {name:"–ü–µ–∫–∞—Ä–Ω—è ¬´–†–∂–∞–Ω–æ–π –∫–æ–ª–æ—Å¬ª",category:"food",city:"–ö–æ—Å—Ç—Ä–æ–º–∞",desc:"–°–Ω–µ–¥—å –ø–æ —Å—Ç–∞—Ä–∏–Ω–Ω—ã–º —Ä–µ—Ü–µ–ø—Ç–∞–º: –∫–∞–ª–∞—á–∏, —Å—É—Ö–∞—Ä–∏, –ø—Ä—è–Ω–∏–∫–∏. –ó–∞–∫–≤–∞—Å–∫–∞ ‚Äî 50 –ª–µ—Ç. –ü–µ—á–∏ ‚Äî –¥—Ä–æ–≤—è–Ω—ã–µ.",links:[{text:"–°–∞–π—Ç",url:"https://rzhanoy-kolos.ru",icon:"üåê"},{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/rzhanoy_kolos",icon:"üõí"}]},
      {name:"¬´–ì–æ—Ä–æ–¥—Å–∫–∞—è –ø–µ—á—å¬ª",category:"food",city:"–ú–æ—Å–∫–≤–∞",desc:"–≠–∫–æ-—Ö–ª–µ–± –Ω–∞ –∑–∞–∫–≤–∞—Å–∫–µ, –±–µ–∑ –¥—Ä–æ–∂–∂–µ–π. –û–ø—Ç–æ–≤—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è –ª–∞–≤–æ–∫ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –º–µ–ª—å–Ω–∏—Ü–∞.",links:[{text:"–°–∞–π—Ç",url:"https://gorodskaya-pech.ru",icon:"üåê"},{text:"Instagram",url:"https://instagram.com/gorodskaya_pech",icon:"üì∏"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–ü—Ä—è–Ω–∏—á–Ω—ã–π –¥–≤–æ—Ä¬ª",category:"food",city:"–í—è–∑—å–º–∞",desc:"–í—è–∑–µ–º—Å–∫–∏–µ –ø—Ä—è–Ω–∏–∫–∏ –ø–æ –ì–û–°–¢ 1950-—Ö. –û—Ç 100 —à—Ç—É–∫ ‚Äî –ø–æ–¥ –¢–ú –∑–∞–∫–∞–∑—á–∏–∫–∞. –£–ø–∞–∫–æ–≤–∫–∞ ‚Äî –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–µ –∫–æ—Ä–æ–±–∞.",links:[{text:"–í–ö",url:"https://vk.com/pryanichny_dvor",icon:"üì±"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–ö–æ–∂–∞ –∏ —Ä–µ–º–µ—Å–ª–æ¬ª",category:"leather",city:"–ú–æ—Å–∫–≤–∞",desc:"–†—É—á–Ω–∞—è –≤—ã–¥–µ–ª–∫–∞ –∫–æ–∂–∏, –ø–æ—à–∏–≤ —Å–∞–ø–æ–≥ –∏ —Å—É–º–æ–∫. –ö–æ–∂–∞ ‚Äî –æ—Ç –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–µ—Ä–º. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ XIX –≤–µ–∫–∞.",links:[{text:"–°–∞–π—Ç",url:"https://kozha-i-remeslo.ru",icon:"üåê"},{text:"Instagram",url:"https://instagram.com/kozha_i_remeslo",icon:"üì∏"}]},
      {name:"–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è ¬´–õ–∞–ø—Ç–∏¬ª",category:"leather",city:"–Ø—Ä–æ—Å–ª–∞–≤–ª—å",desc:"–õ–∞–ø—Ç–∏, –ø–æ—è—Å–∞, –Ω–æ–∂–Ω—ã. –†–∞–±–æ—Ç–∞–µ–º —Å –ª—ã–∫–æ–º –∏ –∫–æ–∂–µ–π. –î–ª—è —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤, —Ç–µ–∞—Ç—Ä–æ–≤, –º—É–∑–µ–µ–≤.",links:[{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/lapti_master",icon:"üõí"},{text:"–í–ö",url:"https://vk.com/lapti_master",icon:"üì±"}]},
      {name:"¬´–°–∏–±–∏—Ä—Å–∫–∏–π —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–∏–∫¬ª",category:"leather",city:"–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫",desc:"–ö–æ–∂–∞–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è –≤ —Å—Ç–∏–ª–µ –°–∏–±–∏—Ä–∏: –Ω–æ–∂–Ω—ã, –ø–æ—è—Å–∞, —Å—É–º–∫–∏. –†–µ–∑—å–±–∞ –ø–æ –∫–æ–∂–µ ‚Äî —Ä—É—á–Ω–∞—è.",links:[{text:"Etsy",url:"https://www.etsy.com/shop/SiberianCraftsman",icon:"üõçÔ∏è"},{text:"Telegram",url:"https://t.me/sib_remeslo",icon:"üí¨"}]},
      {name:"–ú–µ–±–µ–ª—å–Ω–∞—è —Å–ª–æ–±–æ–¥–∞",category:"furniture",city:"–ü—Å–∫–æ–≤",desc:"–°—Ç–æ–ª—ã, –ª–∞–≤–∫–∏, —Å—É–Ω–¥—É–∫–∏. –°–±–æ—Ä–∫–∞ ‚Äî –Ω–∞ —à–∫–∞–Ω—Ç–∞—Ö –∏ –∫–ª–µ—é. –õ–∞–∫ ‚Äî –º–∞—Å–ª—è–Ω—ã–π. –î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –≤–æ—Ä–æ—Ç.",links:[{text:"–°–∞–π—Ç",url:"https://mebel-sloboda.ru",icon:"üåê"},{text:"–í–ö",url:"https://vk.com/mebel_sloboda",icon:"üì±"}]},
      {name:"–ê—Ä—Ç–µ–ª—å ¬´–†—É—Å—Å–∫–∞—è –º–µ–±–µ–ª—å¬ª",category:"furniture",city:"–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",desc:"–ê–Ω—Ç—É—Ä–∞–∂–Ω–∞—è –º–µ–±–µ–ª—å –ø–æ–¥ —Å—Ç–∞—Ä–∏–Ω—É: –∫–∞–±–∏–Ω–µ—Ç—ã, —à–∫–∞—Ñ—ã-–∫—É–ø–µ, –∫—Ä–æ–≤–∞—Ç–∏. –î–ª—è –æ—Å–æ–±–Ω—è–∫–æ–≤ –∏ –æ—Ç–µ–ª–µ–π.",links:[{text:"–°–∞–π—Ç",url:"https://russkaya-mebel.spb.ru",icon:"üåê"}]},
      {name:"¬´–î—É–±—Ä–∞–≤–∞¬ª",category:"furniture",city:"–ö–∞–∑–∞–Ω—å",desc:"–ö—É—Ö–Ω–∏ –∏ –∫–æ—Ä–ø—É—Å–Ω–∞—è –º–µ–±–µ–ª—å –∏–∑ –º–∞—Å—Å–∏–≤–∞. –û—Ç 5 –∫–æ–º–ø–ª–µ–∫—Ç–æ–≤ ‚Äî –ø–æ–¥ –ø—Ä–æ–µ–∫—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞.",links:[{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/dubrava_kazan",icon:"üõí"},{text:"–í–ö",url:"https://vk.com/dubrava_kazan",icon:"üì±"}]},
      {name:"–°—Ç–æ–ª—è—Ä–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è ¬´–†–µ–∑–µ—Ü¬ª",category:"furniture",city:"–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",desc:"–†–µ–∑–Ω–∞—è –º–µ–±–µ–ª—å: —Å–ø–∏–Ω–∫–∏ —Å—Ç—É–ª—å–µ–≤, –∏–∑–≥–æ–ª–æ–≤—å—è, –ø–∞–Ω–Ω–æ. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞–Ω–∫–∏ + —Ä—É–∫–∞ –º–∞—Å—Ç–µ—Ä–∞.",links:[{text:"Instagram",url:"https://instagram.com/rezets_master",icon:"üì∏"}]},
      {name:"–ü–∏—Å—Ü–æ–≤–∞—è –ø–∞–ª–∞—Ç–∞",category:"printing",city:"–ú–æ—Å–∫–≤–∞",desc:"–†—É—á–Ω—ã–µ —Å–≤–∏—Ç–∫–∏, –≥–µ—Ä–±—ã, –≥—Ä–∞–º–æ—Ç—ã –Ω–∞ –ø–µ—Ä–≥–∞–º–µ–Ω–µ. –ß–µ—Ä–Ω–∏–ª–∞ ‚Äî —Å–∞–∂–µ–≤—ã–µ, –ø–µ—Ä—å—è ‚Äî –≥—É—Å–∏–Ω—ã–µ.",links:[{text:"–Ø.–ú–∞—Å—Ç–µ—Ä–∞",url:"https://yarmarka-masterov.ru/shop/pists_palata",icon:"üõí"},{text:"–í–ö",url:"https://vk.com/pists_palata",icon:"üì±"}]},
      {name:"–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è ¬´–õ—É–±–æ–∫¬ª",category:"printing",city:"–°–µ—Ä–≥–∏–µ–≤ –ü–æ—Å–∞–¥",desc:"–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ª—É–±–∫–∏ –∏ –≥—Ä–∞–≤—é—Ä—ã. –¢–∏—Ä–∞–∂ ‚Äî –æ—Ç 50 —ç–∫–∑. –ü–µ—á–∞—Ç—å ‚Äî –Ω–∞ —Å—Ç–∞—Ä–æ–º –ø–ª–æ—Å–∫–æ–ø–µ—á–∞—Ç–Ω–æ–º —Å—Ç–∞–Ω–∫–µ.",links:[{text:"–°–∞–π—Ç",url:"https://lubok-master.ru",icon:"üåê"}]},
      {name:"¬´–ü–µ—Ä–æ –∏ —Å–ª–æ–≤–æ¬ª",category:"printing",city:"–Ø—Ä–æ—Å–ª–∞–≤–ª—å",desc:"–ö–Ω–∏–≥–∏ —Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–ø–ª—ë—Ç–∞, —ç–∫—Å–ª–∏–±—Ä–∏—Å—ã, –≤–∏–∑–∏—Ç–∫–∏ –≤ —Å—Ç–∏–ª–µ XIX –≤–µ–∫–∞. –®—Ç–∞–º–ø—ã ‚Äî –ª–∞—Ç—É–Ω–Ω—ã–µ.",links:[{text:"Etsy",url:"https://www.etsy.com/shop/PeroISlovo",icon:"üõçÔ∏è"}]},
      {name:"–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ–π–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è",category:"metal",city:"–ß–µ–ª—è–±–∏–Ω—Å–∫",desc:"–õ–∏—Ç—å—ë —á—É–≥—É–Ω–∞ –∏ –±—Ä–æ–Ω–∑—ã: —É—Ç—é–≥–∏, –ø–æ–¥—Å–≤–µ—á–Ω–∏–∫–∏, —Å–∫—É–ª—å–ø—Ç—É—Ä–∞. –§–æ—Ä–º—ã ‚Äî –ø–æ —á–µ—Ä—Ç–µ–∂–∞–º –∑–∞–∫–∞–∑—á–∏–∫–∞.",links:[{text:"–°–∞–π—Ç",url:"https://litmaster.ru",icon:"üåê"}]},
      {name:"–¶–µ—Ö —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–µ—Ä–∞–º–∏–∫–∏",category:"ceramics",city:"–ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫",desc:"–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–µ—Ä–∞–º–∏–∫–∞ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –î–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –æ—Ç–µ–ª–µ–π, —á–∞—Å—Ç–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤.",links:[{text:"Instagram",url:"https://instagram.com/ceramic_art_ru",icon:"üì∏"}]}
    ];

    let ads = JSON.parse(localStorage.getItem('ads') || '[]');
    let dbClient = null;
    let isYDBConnected = false;

    // === YDB INIT ===
    async function initYDB() {
      if (YDB_CONFIG.iamKey === 'YOUR_IAM_KEY_HERE') return;
      try {
        const driver = await new Ydb.Driver({
          endpoint: YDB_CONFIG.endpoint,
          database: YDB_CONFIG.database,
          credentials: new Ydb.credentials.IamAuth(YDB_CONFIG.iamKey)
        });
        await driver.ready();
        dbClient = new Ydb.SessionPool(driver);
        isYDBConnected = true;
      } catch (e) {}
    }

    // === CRUD ===
    async function queryYDB(query, params = {}) {
      if (!isYDBConnected) return null;
      try {
        const session = await dbClient.acquire();
        const result = await session.executeQuery(query, params);
        await dbClient.release(session);
        return result;
      } catch (e) { return null; }
    }

    async function loadAds() {
      const container = document.getElementById('adsContainer');
      container.innerHTML = '<div class="empty-state"><h3>–ó–∞–≥—Ä—É–∂–∞—é —Å –¥–æ—Å–∫–∏...</h3></div>';

      if (isYDBConnected) {
        const res = await queryYDB(`
          SELECT id, title, category, description, image_url, created_at
          FROM ads ORDER BY created_at DESC
        `);
        if (res?.resultSets?.[0]) {
          ads = res.resultSets[0].rows.map(r => ({
            id: r.id.value,
            title: r.title.value,
            category: r.category.value,
            description: r.description.value,
            image_url: r.image_url?.value || null,
            created_at: r.created_at.value
          }));
          localStorage.setItem('ads', JSON.stringify(ads));
          renderAds();
          return;
        }
      }
      ads = JSON.parse(localStorage.getItem('ads') || '[]');
      renderAds();
    }

    async function saveAd(ad) {
      if (isYDBConnected) {
        const res = await queryYDB(`
          INSERT INTO ads (title, category, description, image_url)
          VALUES ($title, $category, $description, $image_url)
          RETURNING id, created_at
        `, {
          '$title': ad.title,
          '$category': ad.category,
          '$description': ad.description,
          '$image_url': ad.image_url || null
        });
        if (res?.resultSets?.[0]?.rows?.[0]) {
          const r = res.resultSets[0].rows[0];
          ad.id = r.id.value;
          ad.created_at = r.created_at.value;
        }
      } else {
        ad.id = Date.now().toString();
        ad.created_at = new Date().toISOString();
      }
      ads.unshift(ad);
      localStorage.setItem('ads', JSON.stringify(ads));
      renderAds();
    }

    async function deleteAd(id) {
      if (!confirm('–°–Ω—è—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å –¥–æ—Å–∫–∏')) return;
      if (isYDBConnected) await queryYDB(`DELETE FROM ads WHERE id = $id`, { '$id': id });
      ads = ads.filter(a => a.id !== id);
      localStorage.setItem('ads', JSON.stringify(ads));
      renderAds();
    }

    // === Render Masters ===
    function renderProducers(category = 'all') {
      const grid = document.getElementById('producersGrid');
      const filtered = category === 'all' ? producers : producers.filter(p => p.category === category);
      
      grid.innerHTML = filtered.map((p, i) => {
        const cat = categories.find(c => c.code === p.category) || categories[0];
        return `
          <div class="producer-card" style="--i: ${i};">
            <div class="card-body">
              <h3>${p.name}</h3>
              <p>${p.desc}</p>
              <div class="producer-meta">
                <span> ${p.city}</span>
                <span>${cat.icon} ${cat.name}</span>
              </div>
              <div class="producer-links">
                ${p.links.map(link => `
                  <a href="${link.url}" target="_blank" class="link-btn website">${link.icon} ${link.text}</a>
                `).join('')}
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // === Render Ads ===
    function renderAds() {
      const container = document.getElementById('adsContainer');
      if (ads.length === 0) {
        container.innerHTML = `<div class="empty-state"><h3>üì≠ –î–æ—Å–∫–∞ –ø—É—Å—Ç–∞</h3><p>–°—Ç–∞–Ω—å –ø–µ—Ä–≤—ã–º ‚Äî –Ω–∞–ø–∏—à–∏ –Ω–∞ –¥–æ—Å–∫—É!</p></div>`;
        return;
      }
      container.innerHTML = ads.map((ad, i) => {
        const cat = categories.find(c => c.code === ad.category) || categories[0];
        const date = new Date(ad.created_at).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' });
        return `
          <div class="ad-card" style="--i: ${i}">
            <div class="ad-header">
              <div class="ad-category-icon">${cat.icon}</div>
              <div class="ad-category-name">${cat.name}</div>
            </div>
            <div class="ad-content">
              <h3 class="ad-title">${escapeHtml(ad.title)}</h3>
              <p class="ad-desc">${escapeHtml(ad.description)}</p>
              <div class="ad-date">üïó ${date}</div>
              <div class="ad-actions">
                <button class="btn-delete" onclick="window.deleteAd('${ad.id}')">–°–Ω—è—Ç—å</button>
                <button class="btn-print" onclick="printAd(${JSON.stringify(ad).replace(/"/g, '&quot;')})">üìú</button>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // === PDF ===
    function printAd(ad) {
      const cat = categories.find(c => c.code === ad.category) || categories[0];
      const date = new Date(ad.created_at).toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' });
      document.getElementById('pdfContent').innerHTML = `
        <h2 style="font-size: 28px; color: #8B0000; margin-bottom: 20px;">${escapeHtml(ad.title)}</h2>
        <p style="font-size: 20px; margin-bottom: 10px;">${cat.icon} <strong>${cat.name}</strong></p>
        <p style="font-size: 18px; line-height: 1.8;">${escapeHtml(ad.description).replace(/\n/g, '<br>')}</p>
        <p style="font-style: italic; color: #2E5D42; margin-top: 30px;">üïó ${date}</p>
      `;
      html2canvas(document.getElementById('pdfPreview')).then(canvas => {
        const pdf = new jspdf.jsPDF('portrait', 'px', [794, 1123]);
        pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, 794, 1123);
        pdf.save(`avos-${ad.title.substring(0, 20).replace(/\W+/g, '-')}.pdf`);
      });
    }

    // === Utils ===
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function initCategoriesForAds() {
      const cont = document.getElementById('categoryIcons');
      cont.innerHTML = categories.map(cat => `
        <div class="category-item ${cat.code === 'metal' ? 'selected' : ''}" data-code="${cat.code}">
          <div class="category-icon">${cat.icon}</div>
          <div>${cat.name}</div>
        </div>
      `).join('');
      cont.querySelectorAll('.category-item').forEach(el => {
        el.addEventListener('click', () => {
          cont.querySelectorAll('.category-item').forEach(e => e.classList.remove('selected'));
          el.classList.add('selected');
          document.getElementById('selectedCategory').value = el.dataset.code;
        });
      });
    }

    // === Particles ===
    const pc = document.getElementById('particles');
    let lt = 0;
    document.addEventListener('mousemove', (e) => {
      if (Date.now() - lt > 50) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.cssText = `
          width: ${Math.random()*8+4}px;
          height: ${Math.random()*8+4}px;
          background: ${['#ff0000','#0040ff'][Math.floor(Math.random()*2)]};
          left: ${e.clientX}px;
          top: ${e.clientY}px;
          animation: fadeOut ${Math.random()*0.5+0.5}s ease-out forwards;
        `;
        pc.appendChild(p);
        setTimeout(() => p.remove(), 1500);
        lt = Date.now();
      }
    });

    // === Global ===
    window.deleteAd = deleteAd;
    window.printAd = printAd;

    // === Init ===
    document.addEventListener('DOMContentLoaded', async () => {
      initCategoriesForAds();
      await initYDB();
      await loadAds();
      renderProducers('all');
      document.querySelector('.filter-btn[data-category="all"]').classList.add('active');

      // –§–∏–ª—å—Ç—Ä—ã –º–∞—Å—Ç–µ—Ä–æ–≤
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          const cat = this.dataset.category;
          renderProducers(cat);
        });
      });

      document.getElementById('adForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const t = document.getElementById('title').value.trim();
        const c = document.getElementById('selectedCategory').value;
        const d = document.getElementById('description').value.trim();
        if (!t || !d) return;
        await saveAd({ title: t, category: c, description: d, image_url: document.getElementById('imageUrl').value.trim() || null });
        e.target.reset();
      });

      const logo = document.getElementById('logoLink');
      logo.addEventListener('mouseenter', () => logo.querySelector('.logo-svg').style.filter = 'drop-shadow(0 0 8px rgba(212, 175, 55, 0.7))');
      logo.addEventListener('mouseleave', () => logo.querySelector('.logo-svg').style.filter = 'none');
    });
  </script>

</body>
</html>